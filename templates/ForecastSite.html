<!DOCTYPE HTML>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='styles/graphics.css') }}">
</head>
<body>
	<div class="navigationBar">
		<a class="active" href="{{ url_for('home') }}">Home</a>
		<a href="{{ url_for('loginPage') }}">Login</a>
		<form action="http://127.0.0.1:5000/LocationReceiver" method="post">
			<select name="locationSelect" id="locationSelect">
				<option value="none">Locations : </option>
			</select>
			<input type="submit">
		</form>
	</div>
	<div class="navbackground"></div>
	<div class="geoChart" id="geoChart"></div>
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script>
		google.charts.load('visualization', {'packages':['geochart'],'mapsApiKey': 'MY_KEY'});
		google.charts.setOnLoadCallback(drawLocationsMap);
		var post = {{ post|tojson }};
		var select = document.getElementById("locationSelect");
		function drawLocationsMap() {
			var post = {{ post|tojson }};
			data = [['City','Sample count']];
			for(var i=0; i < post.sampleCounts.length; i++){
				data.push([post.locationNames[i],post.sampleCounts[i]]);
			}
			console.log(data);
			var dataTable = google.visualization.arrayToDataTable(data);
			var options = {
				title: 'Geo map',
				sizeAxis: {minValue: 0, maxSize: 15},
				region: 'world',
				displayMode: 'markers',
				markerOpacity: 0.8,
				legend: {texStyle: {color: 'black', fontSize: 16}},
				colorAxis: {colors: ['yellow', 'purple']}
			};
			var chart = new google.visualization.GeoChart(document.getElementById('geoChart'));
			chart.draw(dataTable, options);
		}
		for (var i=0; i < post.locationNames.length; i++){
			var option = document.createElement("option");
			option.value = post.locationNames[i];
			option.innerHTML = post.locationNames[i];
			select.appendChild(option);
		}
	</script>
</body>
</html>